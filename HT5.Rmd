---
title: "Hoja de Trabajo 05"
author: "Gustavo de León y Andrés Urízar"
date: "3/24/2020"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Objetivo
Predecir los precios con el algoritmo de Naives Bayes
```{r echo=FALSE}
  library(e1071)
  library(caret)
  library(plyr)
  #Ubicacion de archivos en computadoras
  setwd("C:/Users/Gustavo/Desktop/SEPTIMO SEMESTRE/MINERIA/HDT5/Hoja-de-trabajo-5")
  #setwd("C:/Users/alber/Documents/UVG/Septimo semestre/Mineria de Datos/Hoja-Trabajo-5/Hoja-de-trabajo-5")
```

```{r}
  train <- read.csv("train.csv", stringsAsFactors = FALSE)
trainImportantes <- train[c("MSSubClass","LotFrontage","LotArea","OverallCond","YearBuilt","YearRemodAdd","X2ndFlrSF","FullBath","TotRmsAbvGrd","KitchenAbvGr","GarageCars","PoolArea","SalePrice")]
trainImportantes[is.na(trainImportantes)]<-0


km<-kmeans(trainImportantes,3)
train$grupo<-km$cluster

g1<- train[train$grupo==1,]
g2<- train[train$grupo==2,]
g3<- train[train$grupo==3,]

train$grupo <- mapvalues(train$grupo, c(1,2,3), c("Caro","Barato","Intermedio"))
```

```{r}
  porcentaje<-0.7
  set.seed(123)
  corte <- sample(nrow(train),nrow(train)*porcentaje)
  train0<-train[corte,]
  test0<-train[-corte,]
```
### Se realiza el calculo de naives bayes
```{r}
  modelo<-naiveBayes(as.factor(grupo)~.,data=train0)
  predBayes<-predict(modelo, newdata = test0[,1:81])
  confusionMatrix(table(predBayes,test0$grupo))
```